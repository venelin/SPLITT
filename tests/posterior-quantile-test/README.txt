The R-scripts and data-files for executing the tests are available in the directory tests/posterior-quantile-test under the SPLITT repository (https://github.com/venelin/SPLITT/). The posterior-quantile tests were executed using the batch LFS system on the Euler HPC provided by ETH Zurich. 

# Directory structure
The directory tests/posterior-quantile-test has the following structure:

Current directory (.):
* ./README.txt  - this text-file.
* ./defineSimReplication_ATSSeG0.R  - a global R script defining one replication.


Directory ./NonUltrametric_N4000_ATSSeG0/exec_20170428 - directory for testing
the model inferences against data simulated over a non-ultrametric birth-death
tree of 4000 tips under the POUMM model. This directory contains the following files:

* NonUltrametric_N4000_ATSSeG0.R  - R script containing chunks of code for manual 
execution, e.g. generation of non-ultrametric tree of 4000 tips, etc.
* j_NonUltrametric_N4000_ATSSeG0.R - R script executing each replication. This
script is automatically generated by a call to benchtable::genBenchJobs function 
found in the file NonUltrametric_N4000_ATSSeG0.R.
* j_bsub_NonUltrametric_N4000_ATSSeG0.sh - shell script running a parallel job 
executing the file j_NonUltrametric_N4000_ATSSeG0.R for a replication id.
* tree_bdsky_stt_N4000_2_1_1.RData - data file containing a non-ultrametric tree
of 4000 tips;
* NonUltrametric_N4000_ATSSeG0.RData - data file containing the seeds for each
replication. 


./NonUltrametric_N4000_ATSSeG0/exec_PMM_20170428 - Same as the directory 
./NonUltrametric_N4000_ATSSeG0/exec_20170428, except that the data is simulated 
under the PMM model. That means that the parameter alpha is fixed to 0 for the 
simulations of data at the beginning of each replication. The files in this directory
are analogical to the files in ./NonUltrametric_N4000_ATSSeG0/exec_20170428.

Directory ./Ultrametric_N4000_ATSSeG0 - same structure as the directory 
./NonUltrametric_N4000_ATSSeG0, except that the tree is ultrametric instead of
non-ultrametric. 

# Running replications on the Euler HPC 
Go to one of the exec_* directories and run the  j_bsub_*.sh shell script.

# Running a replication on a local computer (no bsub) 
Go to one of the exec_* directories and run a command such as:
 R --vanilla --slave -f j_NonUltrametric_N4000_ATSSeG0.R --args replication NonUltrametric_N4000_ATSSeG0.RData NULL 532 
 
In the above command the last number 532 indicates the replication id and the file-name NonUltrametric_N4000_ATSSeG0.RData is needed by the benchtable package. 

# Collecting results after running the jobs
Read the file ms-figures/AnalysisAndFigures.Rmd found in the SPLITT repository.